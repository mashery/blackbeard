/*! blackbeard v0.2.0 | (c) 2017 Chris Ferdinandi | LicenseRef-All Rights Reserved License | http://github.com/mashery/blackbeard */
var ioDocs=(function(){"use strict";var e,t,o,n,r,i,c,a,u,l,s={},d="io-docs-hide",f=function(e){return"string"==typeof e&&e.toLowerCase().indexOf("json")>=0?"json":"text"},m=function(e){return e.getAttribute("data-auth-type")},p=function(e){return JSON.parse(e.getAttribute("data-available-keys"))},h=function(e){return"true"===e.getAttribute("data-basic-auth")},y=function(e){e&&e.classList.remove(d)},S=function(e){e&&e.classList.add(d)},v=function(){e.forEach((function(e){S(e)}))},q=function(){document.querySelectorAll(".credentials.oauth2").forEach((function(e){e.matches(".credentials_start")||S(e)}))},g=function(){o.forEach((function(e){S(e)}))},w=function(e){var t=document.querySelectorAll("#apiDescription"+e);g(),t.forEach((function(e){y(e)}))},A=function(){S(n)},_=function(){y(n)},C=function(){r.forEach((function(e){S(e)}))},b=function(e){document.querySelectorAll('[data-api-id="'+e+'"]').forEach((function(e){y(e)}))},E=function(){a.forEach((function(e){y(e)}))},O=function(){var e=!!document.querySelector("li.endpoint > ul.methods."+d);a.forEach((function(t){e?y(t):S(t)})),e||M()},L=function(e){var t=e.querySelector("ul.methods");t&&(t.classList.contains(d)?y(t):S(t))},M=function(){c.forEach((function(e){S(e)}))},k=function(){var e=!!document.querySelector("li.method form."+d);c.forEach((function(t){e?y(t):S(t)})),e&&document.querySelector("li.endpoint > ul.methods."+d)&&E()},j=function(e){var t=e.querySelector("form");t&&(t.classList.contains(d)?y(t):S(t))},K=function(){v(),g(),A(),C()},T=function(){K(),t.reset();var e=document.querySelector("#api"+i.value),o=m(e),n=document.querySelector(".credentials_start."+o),r=p(e);switch(h(e)&&y(document.querySelector("#apiBasicAuthCredFlowContainer")),o){case"key":if(S(document.querySelector("#apiSecretContainer")),S(document.querySelector("#apiKeySecretListContainer")),S(document.querySelector("#apiKeyContainer")),r&&r.length){var c=document.querySelector("#apiKeySecret");c.innerHTML="",r.forEach((function(e,t){var o="";o=e.application?e.application+": "+e.key:e.key,c.innerHTML+='<option data-secret="'+e.secret+'" value="'+e.key+'">'+o+"</option>"})),y(document.querySelector("#apiKeySecretListContainer")),u&&(y(document.querySelector("#apiSecretContainer")),S(document.querySelector("#showManualKeySecret")))}else y(document.querySelector("#apiKeyContainer")),"1"===e.getAttribute("data-secret")&&y(document.querySelector("#apiSecretContainer"));break;case"oauth2":var a=JSON.parse(e.getAttribute("data-auth-flows")),l=document.querySelector("#apiOAuth2FlowType");if(l.innerHTML="",S(document.querySelector("#apiOAuth2PresetKeysContainer")),a&&a.forEach((function(e,t){l.innerHTML+='<option value="'+e+'">'+(function(e){switch(e){case"auth_code":return"Authorization Code / Web Server";case"implicit":return"Implicit / Javascript Client";case"password_cred":return"Password Credentials";case"client_cred":return"Client Credentials";default:return"Unknown"}})(e)+"</option>"})),r&&r.length>0){var s=document.querySelector("#apiOAuth2PresetKeys");s.innerHTML="",s+='<option value="__manual">Manual Input</option>',r.forEach((function(e,t){s.innerHTML+='<option data-secret="'+e.secret+'" value="'+e.key+'">'+e.application+"</option>"})),y(document.querySelector("#apiOAuth2PresetKeysContainer"))}J(l)}y(n)},I=function(e){if(!e||e.length<1)return void K();T(),w(e),_(),C(),b(e)},J=function(e){if(q(),!(e.value.length<1))switch(e.value){case"auth_code":y(document.querySelector("#apiOAuth2AuthCodeFlowContainer"));break;case"implicit":y(document.querySelector("#apiOAuth2ImplicitFlowContainer"));break;case"password_cred":y(document.querySelector("#apiOAuth2PasswordCredFlowContainer"));break;case"client_cred":y(document.querySelector("#apiOAuth2ClientCredFlowContainer"))}},x=function(e){"__manual"===e.value||e.value.length<1?(document.querySelector(".oauth2_client_id_field").value="",document.querySelector(".oauth2_client_secret_field").value=""):(document.querySelector(".oauth2_client_id_field").value=e.value,document.querySelector(".oauth2_client_secret_field").value=e.getAttribute("data-secret"))},B=function(e){if(console.log(l),console.log("ace"in window),l&&"ace"in window){var t=e.closest("li.method").querySelector("form"),o=t.querySelector(".requestBody"),n=t.querySelector(".parameters"),r="text",i=t.querySelector(".request-body-editor");if(i){if(!e.editor){if(n){var c=n.querySelector('[name="params[Content-Type]"]');c=c?c.value:null,r=f(c)}e.editor=ace.edit(i),e.editor.getSession().setMode("ace/mode/"+r)}S(o),i.style.height=window.getComputedStyle(o).height}}},D=function(e){e.properties&&e.properties.forEach((function(e,t){e.title||(e.title=t.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,(function(e){return e.toUpperCase()}))),e.$ref&&0!==e.$ref.indexOf("#")&&(e.$ref="#/definitions/"+e.$ref),e.items&&e.items.$ref&&0!==e.items.$ref.indexOf("#")&&(e.items.$ref="#/definitions/"+e.items.$ref),"object"===e.type?D(e.properties):"array"===e.type&&D(e.items.properties)}))},F=function(e){var t={};if(e.properties)return e.properties.forEach((function(e,o){if("array"===e.type){var n=F(e.items);t[o]||(t[o]={items:{}}),t[o].toolbarSticky=!0,t[o].fieldClass="iodoc-array-field",t[o].items.showMoveUpItemButton=!1,t[o].items.showMoveDownItemButton=!1,Object.keys(n).length>0&&(t[o].fields={item:{fields:n}})}else e.properties&&(t[o]||(t[o]={fields:{}}),t[o].fields=F(e))})),t},H=function(){r.forEach((function(e){var t=window.mashery.content.schemas[e.id];if(t&&!(Object.keys(t).length<1)){e.querySelectorAll(".requestBodySchemaContainer").forEach((function(e){var o=e.getAttribute("data-request-body-schema-id");if(o){var n=e.closest("form"),r=t[o];if(r&&n){var i=$.extend({definitions:t},r),c=F(i),a=JSON.parse(e.getAttribute("data-request-body-default-value"));$(e).alpaca({schema:i,data:a,options:$.extend({name:"requestBody"},{fields:c})})}}}))}})),l=!0},P=function(){r.forEach((function(e){var t=window.mashery.content.schemas[e.id];!t||Object.keys(t).length<1||t.forEach((function(e,t){e.title||(e.title=schemaId),D(e)}))})),document.querySelectorAll(".requestBodySchemaContainer").forEach((function(e){e.innerHTML=""})),"jQuery"in window?m$.loadJS("/public/Mashery/scripts/vendor/alpaca.min.js",H):m$.loadJS("https://code.jquery.com/jquery-1.8.3.min.js",(function(){m$.loadJS("/public/Mashery/scripts/vendor/alpaca.min.js",H)})),m$.loadJS("/public/Mashery/scripts/Mashery/ace/ace.js")},N=function(e){return e.target.matches("#apiOAuth2FlowType")?void J(e.target):e.target.matches("#apiOAuth2PresetKeys")?void x(e.target):void(e.target.matches("#apiId")&&I(e.target.value))},U=function(e){e.target.closest(".endpoint h3.title")&&L(e.target.closest(".endpoint")),e.target.closest(".method div.title")&&(j(e.target.closest(".method")),B(e.target)),e.target.closest("#toggleEndpoints")&&(e.preventDefault(),O()),e.target.closest("#toggleMethods")&&(e.preventDefault(),k())};return s.init=function(){e=document.querySelectorAll(".credentials"),t=document.querySelector("#credentials"),o=document.querySelectorAll(".apiDescriptionList"),n=document.querySelector("#controls"),r=document.querySelectorAll(".endpointList"),i=document.querySelector("#apiId"),c=document.querySelectorAll("li.method > form"),a=document.querySelectorAll("li.endpoint > ul.methods"),u=!!(document.querySelector("[name=enable_high_security_secret_management]")&&document.querySelector("[name=enable_high_security_secret_management]").value.length>0),console.log("IO Docs is running!"),window.addEventListener("change",N,!1),document.addEventListener("click",U,!1),M(),P(),1===r.length&&(i.value=i.options[1].value,I(i.value)),i.value.length>0&&I(i.value)},s})();