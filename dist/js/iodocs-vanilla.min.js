/*! blackbeard v0.2.0 | (c) 2017 Chris Ferdinandi | LicenseRef-All Rights Reserved License | http://github.com/mashery/blackbeard */
var ioDocs=(function(){"use strict";var e,t,n,o,r,i,c,a,u,l,s,d={},f="io-docs-hide",m=function(e){return"string"==typeof e&&e.toLowerCase().indexOf("json")>=0?"json":"text"},p=function(e){return e.getAttribute("data-auth-type")},y=function(e){return JSON.parse(e.getAttribute("data-available-keys"))},h=function(e){return"true"===e.getAttribute("data-basic-auth")},S=function(e){e&&e.classList.remove(f)},v=function(e){e&&e.classList.add(f)},q=function(){e.forEach((function(e){v(e)}))},g=function(){document.querySelectorAll(".credentials.oauth2").forEach((function(e){e.matches(".credentials_start")||v(e)}))},w=function(){var e=t.querySelector("input[name=ajax_synchronization_token]");s=e?e.value:""},_=function(){n.forEach((function(e){v(e)}))},A=function(e){var t=document.querySelectorAll("#apiDescription"+e);_(),t.forEach((function(e){S(e)}))},C=function(){v(o)},b=function(){S(o)},E=function(){r.forEach((function(e){v(e)}))},O=function(e){document.querySelectorAll('[data-api-id="'+e+'"]').forEach((function(e){S(e)}))},L=function(){a.forEach((function(e){S(e)}))},k=function(){var e=!!document.querySelector("li.endpoint > ul.methods."+f);a.forEach((function(t){e?S(t):v(t)})),e||j()},M=function(e){var t=e.querySelector("ul.methods");t&&(t.classList.contains(f)?S(t):v(t))},j=function(){c.forEach((function(e){v(e)}))},K=function(){var e=!!document.querySelector("li.method form."+f);c.forEach((function(t){e?S(t):v(t)})),e&&document.querySelector("li.endpoint > ul.methods."+f)&&L()},T=function(e){var t=e.querySelector("form");t&&(t.classList.contains(f)?S(t):v(t))},I=function(){q(),_(),C(),E()},x=function(){I(),t.reset();var e=document.querySelector("#api"+i.value),n=p(e),o=document.querySelector(".credentials_start."+n),r=y(e);switch(h(e)&&S(document.querySelector("#apiBasicAuthCredFlowContainer")),n){case"key":if(v(document.querySelector("#apiSecretContainer")),v(document.querySelector("#apiKeySecretListContainer")),v(document.querySelector("#apiKeyContainer")),r&&r.length){var c=document.querySelector("#apiKeySecret");c.innerHTML="",r.forEach((function(e,t){var n="";n=e.application?e.application+": "+e.key:e.key,c.innerHTML+='<option data-secret="'+e.secret+'" value="'+e.key+'">'+n+"</option>"})),S(document.querySelector("#apiKeySecretListContainer")),u&&(S(document.querySelector("#apiSecretContainer")),v(document.querySelector("#showManualKeySecret")))}else S(document.querySelector("#apiKeyContainer")),"1"===e.getAttribute("data-secret")&&S(document.querySelector("#apiSecretContainer"));break;case"oauth2":var a=JSON.parse(e.getAttribute("data-auth-flows")),l=document.querySelector("#apiOAuth2FlowType");if(l.innerHTML="",v(document.querySelector("#apiOAuth2PresetKeysContainer")),a&&a.forEach((function(e,t){l.innerHTML+='<option value="'+e+'">'+(function(e){switch(e){case"auth_code":return"Authorization Code / Web Server";case"implicit":return"Implicit / Javascript Client";case"password_cred":return"Password Credentials";case"client_cred":return"Client Credentials";default:return"Unknown"}})(e)+"</option>"})),r&&r.length>0){var s=document.querySelector("#apiOAuth2PresetKeys");s.innerHTML="",s+='<option value="__manual">Manual Input</option>',r.forEach((function(e,t){s.innerHTML+='<option data-secret="'+e.secret+'" value="'+e.key+'">'+e.application+"</option>"})),S(document.querySelector("#apiOAuth2PresetKeysContainer"))}B(l)}S(o)},J=function(e){if(!e||e.length<1)return void I();x(),A(e),b(),E(),O(e)},B=function(e){if(g(),!(e.value.length<1))switch(e.value){case"auth_code":S(document.querySelector("#apiOAuth2AuthCodeFlowContainer"));break;case"implicit":S(document.querySelector("#apiOAuth2ImplicitFlowContainer"));break;case"password_cred":S(document.querySelector("#apiOAuth2PasswordCredFlowContainer"));break;case"client_cred":S(document.querySelector("#apiOAuth2ClientCredFlowContainer"))}},D=function(e){"__manual"===e.value||e.value.length<1?(document.querySelector(".oauth2_client_id_field").value="",document.querySelector(".oauth2_client_secret_field").value=""):(document.querySelector(".oauth2_client_id_field").value=e.value,document.querySelector(".oauth2_client_secret_field").value=e.getAttribute("data-secret"))},F=function(e){if(console.log(l),console.log("ace"in window),l&&"ace"in window){var t=e.closest("li.method").querySelector("form"),n=t.querySelector(".requestBody"),o=t.querySelector(".parameters"),r="text",i=t.querySelector(".request-body-editor");if(i){if(!e.editor){if(o){var c=o.querySelector('[name="params[Content-Type]"]');c=c?c.value:null,r=m(c)}e.editor=ace.edit(i),e.editor.getSession().setMode("ace/mode/"+r)}v(n),i.style.height=window.getComputedStyle(n).height}}},H=function(e){e.properties&&e.properties.forEach((function(e,t){e.title||(e.title=t.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,(function(e){return e.toUpperCase()}))),e.$ref&&0!==e.$ref.indexOf("#")&&(e.$ref="#/definitions/"+e.$ref),e.items&&e.items.$ref&&0!==e.items.$ref.indexOf("#")&&(e.items.$ref="#/definitions/"+e.items.$ref),"object"===e.type?H(e.properties):"array"===e.type&&H(e.items.properties)}))},P=function(e){var t={};if(e.properties)return e.properties.forEach((function(e,n){if("array"===e.type){var o=P(e.items);t[n]||(t[n]={items:{}}),t[n].toolbarSticky=!0,t[n].fieldClass="iodoc-array-field",t[n].items.showMoveUpItemButton=!1,t[n].items.showMoveDownItemButton=!1,Object.keys(o).length>0&&(t[n].fields={item:{fields:o}})}else e.properties&&(t[n]||(t[n]={fields:{}}),t[n].fields=P(e))})),t},z=function(){r.forEach((function(e){var t=window.mashery.content.schemas[e.id];if(t&&!(Object.keys(t).length<1)){e.querySelectorAll(".requestBodySchemaContainer").forEach((function(e){var n=e.getAttribute("data-request-body-schema-id");if(n){var o=e.closest("form"),r=t[n];if(r&&o){var i=$.extend({definitions:t},r),c=P(i),a=JSON.parse(e.getAttribute("data-request-body-default-value"));$(e).alpaca({schema:i,data:a,options:$.extend({name:"requestBody"},{fields:c})})}}}))}})),l=!0},N=function(){r.forEach((function(e){var t=window.mashery.content.schemas[e.id];!t||Object.keys(t).length<1||t.forEach((function(e,t){e.title||(e.title=schemaId),H(e)}))})),document.querySelectorAll(".requestBodySchemaContainer").forEach((function(e){e.innerHTML=""})),"jQuery"in window?m$.loadJS("/public/Mashery/scripts/vendor/alpaca.min.js",z):m$.loadJS("https://code.jquery.com/jquery-1.8.3.min.js",(function(){m$.loadJS("/public/Mashery/scripts/vendor/alpaca.min.js",z)})),m$.loadJS("/public/Mashery/scripts/Mashery/ace/ace.js")},U=function(e){return e.target.matches("#apiOAuth2FlowType")?void B(e.target):e.target.matches("#apiOAuth2PresetKeys")?void D(e.target):void(e.target.matches("#apiId")&&J(e.target.value))},Q=function(e){e.target.closest(".endpoint h3.title")&&M(e.target.closest(".endpoint")),e.target.closest(".method div.title")&&(T(e.target.closest(".method")),F(e.target)),e.target.closest("#toggleEndpoints")&&(e.preventDefault(),k()),e.target.closest("#toggleMethods")&&(e.preventDefault(),K())};return d.init=function(){e=document.querySelectorAll(".credentials"),t=document.querySelector("#credentials"),n=document.querySelectorAll(".apiDescriptionList"),o=document.querySelector("#controls"),r=document.querySelectorAll(".endpointList"),i=document.querySelector("#apiId"),c=document.querySelectorAll("li.method > form"),a=document.querySelectorAll("li.endpoint > ul.methods"),u=!!(document.querySelector("[name=enable_high_security_secret_management]")&&document.querySelector("[name=enable_high_security_secret_management]").value.length>0),console.log("IO Docs is running!"),window.addEventListener("change",U,!1),document.addEventListener("click",Q,!1),j(),N(),w(),1===r.length&&(i.value=i.options[1].value,J(i.value)),i.value.length>0&&J(i.value)},d})();