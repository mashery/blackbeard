/*! blackbeard vbeta | (c) 2017 Chris Ferdinandi | LicenseRef-All Rights Reserved License | http://github.com/mashery/blackbeard */
var customizer=function(){"use strict";var s,e,t,n,i,o,c,r,a,u,l="https://api.github.com/repos/mashery/blackbeard/contents/dist/",d=document.querySelector("#download-custom-js"),m=document.querySelector("#download-custom-css"),f=document.querySelector("#download-size"),g=document.querySelector("#download-init"),p=sessionStorage.getItem("portalCustomizerCache"),j=p?JSON.parse(p):{},h=function(){var s="";if(o.length>0&&(s+=o),c.length>0&&(s+="\n\nwindow.addEventListener('portalAfterRender', function () {\n"+c+"}, false)"),s.length<1)return void(g.innerHTML="// No initialization needed...");g.innerHTML=s.replace(new RegExp("<","g"),"&lt;").replace(new RegExp(">","g"),"&gt;").trim(),"Prism"in window&&Prism.highlightAll()},v=function(){if(t.length<1)return void h();t.forEach((function(s){var e=s.getAttribute("value");s.classList.contains("has-inits")?j[l+"inits/"+e+".js"]?(o+=j[l+"inits/"+e+".js"]+"\n\n",h()):atomic.ajax({url:l+"inits/"+e+".js"}).success((function(s){j[l+"inits/"+e+".js"]=atob(s.content),o+=j[l+"inits/"+e+".js"]+"\n\n",sessionStorage.setItem("portalCustomizerCache",JSON.stringify(j)),h()})).error((function(s){h(),console.error(e+" wasn't found")})):h(),s.classList.contains("has-events")?j[l+"events/"+e+".js"]?(c+="\t"+j[l+"events/"+e+".js"].replace(new RegExp("\n","g"),"\n\t")+"\n",h()):atomic.ajax({url:l+"events/"+e+".js"}).success((function(s){j[l+"events/"+e+".js"]=atob(s.content),c+="\t"+j[l+"events/"+e+".js"].replace(new RegExp("\n","g"),"\n\t")+"\n",sessionStorage.setItem("portalCustomizerCache",JSON.stringify(j)),h()})).error((function(s){h(),console.error(e+" wasn't found")})):h()}))},S=function(){j[l+"inits/"+e+".js"]?(o=j[l+"inits/"+e+".js"],v()):atomic.ajax({url:l+"inits/"+e+".js"}).success((function(s){j[l+"inits/"+e+".js"]=atob(s.content),o=j[l+"inits/"+e+".js"],sessionStorage.setItem("portalCustomizerCache",JSON.stringify(j)),v()})).error((function(s){v(),console.error(e+" wasn't found")}))},z=function(s){return Math.round(100*s/1024)/100+"kb"},y=function(){var s=r+a,e=Math.round(100*r/s)+"%",t=Math.round(100*a/s)+"%";f.innerHTML="<p>Total Filesize: <strong>"+z(s)+"</strong> ("+e+" JavaScript and "+t+" CSS)</p>"},w=function(t,n){if(n.length<1)return void(t.innerHTML="No "+("download-custom-js"===t.id?"JavaScript":"CSS")+" Needed");t.classList.remove("disabled"),t.href="data:application/octet-stream;charset=utf-8,"+encodeURIComponent(n),t.innerHTML="Download "+("download-custom-js"===t.id?"JavaScript":"CSS"),t.download=e+s+("download-custom-js"===t.id?".js":".css"),y()},C=function(){d.classList.add("disabled"),d.href="",d.innerHTML="Generating...",m.classList.add("disabled"),m.href="",m.innerHTML="Generating...",f.innerHTML="",g.innerHTML="Generating..."},b=function(){j[l+"css/overrides"+s+".css"]?(i+=j[l+"css/overrides"+s+".css"].styles,a+=j[l+"css/overrides"+s+".css"].size,w(m,i)):atomic.ajax({url:l+"css/overrides"+s+".css"}).success((function(e){j[l+"css/overrides"+s+".css"]={styles:atob(e.content),size:e.size},i+=j[l+"css/overrides"+s+".css"].styles,a+=j[l+"css/overrides"+s+".css"].size,sessionStorage.setItem("portalCustomizerCache",JSON.stringify(j)),w(m,i)})).error((function(s){}))},L=function(){if(t.length<1)return w(d,n),w(m,i),void b();var e=t.length-1;t.forEach((function(t,o){var c=t.getAttribute("value");t.classList.contains("has-js")?j[l+"js/"+c+s+".js"]?(n+=j[l+"js/"+c+s+".js"].scripts,r+=j[l+"js/"+c+s+".js"].size,w(d,n)):atomic.ajax({url:l+"js/"+c+s+".js"}).success((function(e){j[l+"js/"+c+s+".js"]={scripts:atob(e.content),size:e.size},n+=j[l+"js/"+c+s+".js"].scripts,r+=j[l+"js/"+c+s+".js"].size,sessionStorage.setItem("portalCustomizerCache",JSON.stringify(j)),w(d,n)})).error((function(s){})):w(d,n),t.classList.contains("has-css")?j[l+"css/"+c+s+".css"]?(i+=j[l+"css/"+c+s+".css"].styles,a+=j[l+"css/"+c+s+".css"].size,w(m,i)):atomic.ajax({url:l+"css/"+c+s+".css"}).success((function(e){j[l+"css/"+c+s+".css"]={styles:atob(e.content),size:e.size},i+=j[l+"css/"+c+s+".css"].styles,a+=j[l+"css/"+c+s+".css"].size,sessionStorage.setItem("portalCustomizerCache",JSON.stringify(j)),w(m,i)})).error((function(s){})):w(m,i),o===e&&b()}))},M=function(){j[l+"css/"+e+s+".css"]?(i=j[l+"css/"+e+s+".css"].styles,a+=j[l+"css/"+e+s+".css"].size,L()):atomic.ajax({url:l+"css/"+e+s+".css"}).success((function(t){j[l+"css/"+e+s+".css"]={styles:atob(t.content),size:t.size},i=j[l+"css/"+e+s+".css"].styles,a+=j[l+"css/"+e+s+".css"].size,sessionStorage.setItem("portalCustomizerCache",JSON.stringify(j)),L()})).error((function(s){}))},T=function(){C(),s="production"===document.querySelector('input[name="compression"]:checked').getAttribute("value")?".min.beta":"",e=document.querySelector('input[name="layout"]:checked').getAttribute("value"),t=document.querySelectorAll('input[name="plugins"]:checked'),n="",i="",o="",c="",r=0,a=0,M(),S()},x=function(){u&&clearTimeout(u),u=setTimeout(T,500)},J=function(s){s.target.closest('input[name="compression"], input[name="layout"], input[name="plugins"]')&&x()};if(!d||!m)return void document.removeEventListener("click",J,!1);document.addEventListener("click",J,!1),x()};